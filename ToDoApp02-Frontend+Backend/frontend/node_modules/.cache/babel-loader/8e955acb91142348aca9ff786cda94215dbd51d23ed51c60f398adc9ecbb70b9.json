{"ast":null,"code":"import React,{useState,memo,useCallback}from'react';import{formatDate}from'../utils/helpers';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const TodoItem=/*#__PURE__*/memo(_ref=>{let{todo,onUpdate,onDelete,loading}=_ref;const[isEditing,setIsEditing]=useState(false);const[editTitle,setEditTitle]=useState(todo.title);const[editDescription,setEditDescription]=useState(todo.description||'');const handleToggleComplete=useCallback(async()=>{try{await onUpdate(todo.id,{completed:!todo.completed});}catch(err){console.error('更新任务状态失败:',err);}},[todo.id,todo.completed,onUpdate]);const handleDelete=useCallback(async()=>{if(window.confirm('确定要删除这个任务吗？')){try{await onDelete(todo.id);}catch(err){console.error('删除任务失败:',err);}}},[todo.id,onDelete]);const handleEdit=useCallback(()=>{setIsEditing(true);setEditTitle(todo.title);setEditDescription(todo.description||'');},[todo.title,todo.description]);const handleSaveEdit=useCallback(async()=>{if(!editTitle.trim())return;try{await onUpdate(todo.id,{title:editTitle.trim(),description:editDescription.trim()||null});setIsEditing(false);}catch(err){console.error('更新任务失败:',err);}},[editTitle,editDescription,todo.id,onUpdate]);const handleCancelEdit=useCallback(()=>{setIsEditing(false);setEditTitle(todo.title);setEditDescription(todo.description||'');},[todo.title,todo.description]);const handleKeyPress=useCallback(e=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();handleSaveEdit();}else if(e.key==='Escape'){handleCancelEdit();}},[handleSaveEdit,handleCancelEdit]);return/*#__PURE__*/_jsxs(\"div\",{className:\"todo-item \".concat(todo.completed?'completed':''),children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",className:\"todo-checkbox\",checked:todo.completed,onChange:handleToggleComplete,disabled:loading}),/*#__PURE__*/_jsx(\"div\",{className:\"todo-content\",children:isEditing?/*#__PURE__*/_jsxs(\"div\",{className:\"edit-form\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"input\",value:editTitle,onChange:e=>setEditTitle(e.target.value),onKeyDown:handleKeyPress,autoFocus:true,maxLength:255}),/*#__PURE__*/_jsx(\"textarea\",{className:\"input textarea\",value:editDescription,onChange:e=>setEditDescription(e.target.value),onKeyDown:handleKeyPress,placeholder:\"\\u4EFB\\u52A1\\u63CF\\u8FF0\\uFF08\\u53EF\\u9009\\uFF09\",maxLength:1000,rows:2}),/*#__PURE__*/_jsxs(\"div\",{className:\"edit-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success btn-sm\",onClick:handleSaveEdit,disabled:!editTitle.trim(),children:\"\\u4FDD\\u5B58\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline btn-sm\",onClick:handleCancelEdit,children:\"\\u53D6\\u6D88\"})]})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"todo-title\",children:todo.title}),todo.description&&/*#__PURE__*/_jsx(\"p\",{className:\"todo-description\",children:todo.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"todo-meta\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u521B\\u5EFA\\u65F6\\u95F4: \",formatDate(todo.created_at)]}),todo.updated_at!==todo.created_at&&/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u66F4\\u65B0\\u65F6\\u95F4: \",formatDate(todo.updated_at)]})]})]})}),!isEditing&&/*#__PURE__*/_jsxs(\"div\",{className:\"todo-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"todo-action-btn complete\",onClick:handleToggleComplete,disabled:loading,title:todo.completed?'标记为未完成':'标记为完成',children:todo.completed?'↩️':'✅'}),/*#__PURE__*/_jsx(\"button\",{className:\"todo-action-btn edit\",onClick:handleEdit,disabled:loading,title:\"\\u7F16\\u8F91\\u4EFB\\u52A1\",children:\"\\u270F\\uFE0F\"}),/*#__PURE__*/_jsx(\"button\",{className:\"todo-action-btn delete\",onClick:handleDelete,disabled:loading,title:\"\\u5220\\u9664\\u4EFB\\u52A1\",children:\"\\uD83D\\uDDD1\\uFE0F\"})]})]});});TodoItem.displayName='TodoItem';export default TodoItem;","map":{"version":3,"names":["React","useState","memo","useCallback","formatDate","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","TodoItem","_ref","todo","onUpdate","onDelete","loading","isEditing","setIsEditing","editTitle","setEditTitle","title","editDescription","setEditDescription","description","handleToggleComplete","id","completed","err","console","error","handleDelete","window","confirm","handleEdit","handleSaveEdit","trim","handleCancelEdit","handleKeyPress","e","key","shiftKey","preventDefault","className","concat","children","type","checked","onChange","disabled","value","target","onKeyDown","autoFocus","maxLength","placeholder","rows","onClick","created_at","updated_at","displayName"],"sources":["D:/PRD PROJECT/ToDoApp02-system/frontend/src/components/TodoItem.js"],"sourcesContent":["import React, { useState, memo, useCallback } from 'react';\r\nimport { formatDate } from '../utils/helpers';\r\n\r\nconst TodoItem = memo(({ todo, onUpdate, onDelete, loading }) => {\r\n  const [isEditing, setIsEditing] = useState(false);\r\n  const [editTitle, setEditTitle] = useState(todo.title);\r\n  const [editDescription, setEditDescription] = useState(todo.description || '');\r\n\r\n  const handleToggleComplete = useCallback(async () => {\r\n    try {\r\n      await onUpdate(todo.id, { completed: !todo.completed });\r\n    } catch (err) {\r\n      console.error('更新任务状态失败:', err);\r\n    }\r\n  }, [todo.id, todo.completed, onUpdate]);\r\n\r\n  const handleDelete = useCallback(async () => {\r\n    if (window.confirm('确定要删除这个任务吗？')) {\r\n      try {\r\n        await onDelete(todo.id);\r\n      } catch (err) {\r\n        console.error('删除任务失败:', err);\r\n      }\r\n    }\r\n  }, [todo.id, onDelete]);\r\n\r\n  const handleEdit = useCallback(() => {\r\n    setIsEditing(true);\r\n    setEditTitle(todo.title);\r\n    setEditDescription(todo.description || '');\r\n  }, [todo.title, todo.description]);\r\n\r\n  const handleSaveEdit = useCallback(async () => {\r\n    if (!editTitle.trim()) return;\r\n    \r\n    try {\r\n      await onUpdate(todo.id, {\r\n        title: editTitle.trim(),\r\n        description: editDescription.trim() || null\r\n      });\r\n      setIsEditing(false);\r\n    } catch (err) {\r\n      console.error('更新任务失败:', err);\r\n    }\r\n  }, [editTitle, editDescription, todo.id, onUpdate]);\r\n\r\n  const handleCancelEdit = useCallback(() => {\r\n    setIsEditing(false);\r\n    setEditTitle(todo.title);\r\n    setEditDescription(todo.description || '');\r\n  }, [todo.title, todo.description]);\r\n\r\n  const handleKeyPress = useCallback((e) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      handleSaveEdit();\r\n    } else if (e.key === 'Escape') {\r\n      handleCancelEdit();\r\n    }\r\n  }, [handleSaveEdit, handleCancelEdit]);\r\n\r\n  return (\r\n    <div className={`todo-item ${todo.completed ? 'completed' : ''}`}>\r\n      <input\r\n        type=\"checkbox\"\r\n        className=\"todo-checkbox\"\r\n        checked={todo.completed}\r\n        onChange={handleToggleComplete}\r\n        disabled={loading}\r\n      />\r\n      \r\n      <div className=\"todo-content\">\r\n        {isEditing ? (\r\n          <div className=\"edit-form\">\r\n            <input\r\n              type=\"text\"\r\n              className=\"input\"\r\n              value={editTitle}\r\n              onChange={(e) => setEditTitle(e.target.value)}\r\n              onKeyDown={handleKeyPress}\r\n              autoFocus\r\n              maxLength={255}\r\n            />\r\n            <textarea\r\n              className=\"input textarea\"\r\n              value={editDescription}\r\n              onChange={(e) => setEditDescription(e.target.value)}\r\n              onKeyDown={handleKeyPress}\r\n              placeholder=\"任务描述（可选）\"\r\n              maxLength={1000}\r\n              rows={2}\r\n            />\r\n            <div className=\"edit-actions\">\r\n              <button\r\n                className=\"btn btn-success btn-sm\"\r\n                onClick={handleSaveEdit}\r\n                disabled={!editTitle.trim()}\r\n              >\r\n                保存\r\n              </button>\r\n              <button\r\n                className=\"btn btn-outline btn-sm\"\r\n                onClick={handleCancelEdit}\r\n              >\r\n                取消\r\n              </button>\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          <>\r\n            <h3 className=\"todo-title\">{todo.title}</h3>\r\n            {todo.description && (\r\n              <p className=\"todo-description\">{todo.description}</p>\r\n            )}\r\n            <div className=\"todo-meta\">\r\n              <span>创建时间: {formatDate(todo.created_at)}</span>\r\n              {todo.updated_at !== todo.created_at && (\r\n                <span>更新时间: {formatDate(todo.updated_at)}</span>\r\n              )}\r\n            </div>\r\n          </>\r\n        )}\r\n      </div>\r\n      \r\n      {!isEditing && (\r\n        <div className=\"todo-actions\">\r\n          <button\r\n            className=\"todo-action-btn complete\"\r\n            onClick={handleToggleComplete}\r\n            disabled={loading}\r\n            title={todo.completed ? '标记为未完成' : '标记为完成'}\r\n          >\r\n            {todo.completed ? '↩️' : '✅'}\r\n          </button>\r\n          <button\r\n            className=\"todo-action-btn edit\"\r\n            onClick={handleEdit}\r\n            disabled={loading}\r\n            title=\"编辑任务\"\r\n          >\r\n            ✏️\r\n          </button>\r\n          <button\r\n            className=\"todo-action-btn delete\"\r\n            onClick={handleDelete}\r\n            disabled={loading}\r\n            title=\"删除任务\"\r\n          >\r\n            🗑️\r\n          </button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n});\r\n\r\nTodoItem.displayName = 'TodoItem';\r\n\r\nexport default TodoItem;\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}